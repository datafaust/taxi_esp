---
title: "Data Exploration"
author: "Fausto Lopez"
date: "April 28, 2017"
output: html_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(data.table)
library(lubridate)
library(ggthemes)
options(scipen = 999)


setwd("C:\\Users\\lopezf\\Desktop\\regression_test\\regression_test")
master = fread("master_raw.csv")[,-1]

```

## Starting with Trends

First we look at the basic trips per day for each type of service:

```{r trends, echo = F}

#look at trips per day 
daily_volume = master[,.(shl_volume = sum(trips_shl)
          ,yellow_volume = sum(trips_med)), by = .(dayz=substr(timestampz, 1, 10))][
            ,total_volume:=shl_volume + yellow_volume]


ggplot(daily_volume, aes(x = dayz, y = total_volume, group = 1)) + 
 geom_line(aes(y = shl_volume, colour = "shl_trips")) +
  geom_line(aes(y = yellow_volume, colour = "yellow_trips")) +
  geom_line(aes(y = total_volume, colour = "total_trips")) + 
  ggtitle("Trips Per Day")+
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme_minimal()

#trips per week
ggplot(master[,.(shl_volume = sum(trips_shl)
          ,yellow_volume = sum(trips_med))
          ,by = .(week = paste0(
            year(timestampz), "-", week(timestampz)
            )
                  )][
            ,total_volume:=shl_volume + yellow_volume], aes(x = week , y = total_volume, group = 1)) + 
 geom_line(aes(y = shl_volume, colour = "shl_trips")) +
  geom_line(aes(y = yellow_volume, colour = "yellow_trips")) +
  geom_line(aes(y = total_volume, colour = "total_trips")) + 
  ggtitle("Trips Per Week")+
    theme(axis.text.x  = element_text(
      vjust = .5,
      size = 8,
      angle = 90
    )) +
  theme_minimal()


```

Lets break down the trips by hour:

```{r, echo = F}
hourly_volume = master[,.(shl_volume = sum(trips_shl)
          ,yellow_volume = sum(trips_med)), by = .(hour=substr(timestampz, 12, 13))][
            ,total_volume:=shl_volume + yellow_volume]

ggplot(hourly_volume, aes(x = hour, y = total_volume, group = 1)) + 
 geom_line(aes(y = shl_volume, colour = "shl_trips")) +
  geom_line(aes(y = yellow_volume, colour = "yellow_trips")) +
  geom_line(aes(y = total_volume, colour = "total_trips")) + 
  ggtitle("Trips Per Hour")+
  theme_minimal()



```


We can combine these two to create an animation that plays out what pickups look like over time by location:

```{r}

```


How have business density changed over time?

```{r}

```

How has citibike usage changed over time?



##Understanding underserved zones





##Bivariate Analysis and Distributions

```{r, distributions, echo = F}
hist(master$gas_price)


```





## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
